

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Self-Calibration of Short-Baseline Execution Blocks &#8212; Reduction Guide</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'step3/step3-selfcal-SBs';</script>
    <link rel="shortcut icon" href="../_static/abaur.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Self-Calibration of SB+LB data" href="step3-selfcal-SBs%2BLBs.html" />
    <link rel="prev" title="Summary of Phase Shifts" href="../step2/step2-summary-of-shifts.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/abaur.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/abaur.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../overview/overview-resources.html">Learning Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/overview-breakdown.html">Breakdown of Our Task</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Step 0 - Getting set up</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../step0/step0-download-data.html">Download the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../step0/step0-program-overview.html">Program Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../step0/step0-restoring-pipeline-calibration.html">Restoring the Pipeline Calibration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../step0/step0-weblog.html">Inspecting the Weblog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../step0/step0-dictionaries.html">Useful Dictionaries</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Step 1 - Prepare the continuum</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../step1/step1-manual-flags.html">Manual Flagging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../step1/step1-pseudo-continuum.html">Pseudocontinuum Measurement Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../step1/step1-initial-continuum-images.html">Initial Continuum Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../step1/step1-initial-self-calibration.html">Initial Self-Calibration</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Step 2 - Phase alignment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../step2/step2-align-LBs.html">Align Long-Baseline Execution Blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../step2/step2-align-SBs.html">Align Short-Baseline Execution Blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../step2/step2-summary-of-shifts.html">Summary of Phase Shifts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Step 3 - Self-calibration of the continuum</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Self-Calibration of Short-Baseline Execution Blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="step3-selfcal-SBs%2BLBs.html">Self-Calibration of SB+LB data</a></li>
<li class="toctree-l1"><a class="reference internal" href="step3-continuum-ms-achieved.html">Create final continuum measurement set</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Step 4 - Prepare the lines</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../step4/step4-manual-flags.html">Manual Flagging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../step4/step4-split-spws.html">Splitting Out Line Spectral Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../step4/step4-apply-phase-alignments.html">Apply Phase Shifts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../step4/step4-apply-self-cal-solutions.html">Apply Self-Calibration Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../step4/step4-continuum-subtraction.html">Continuum Subtraction</a></li>

<li class="toctree-l1"><a class="reference internal" href="../step4/step4-line-mses-achieved.html">Create final line measurement sets</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Imaging - Continuum</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../imaging-cont/imaging-cont-procedure.html">Procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../imaging-cont/imaging-cont-preliminary-images.html">Preliminary Images</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Imaging - Lines</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../imaging-lines/imaging-lines-procedure.html">Procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../imaging-lines/imaging-lines-dirty-images.html">Dirty Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../imaging-lines/imaging-lines-initial-approaches.html">Initial Approaches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../imaging-lines/imaging-lines-adopted-approach.html">Adopted Approach</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jjspeedie/guide.2021.1.00690.S" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jjspeedie/guide.2021.1.00690.S/issues/new?title=Issue%20on%20page%20%2Fstep3/step3-selfcal-SBs.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/step3/step3-selfcal-SBs.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Self-Calibration of Short-Baseline Execution Blocks</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-path-through-self-calibration">Summary of path through self-calibration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explanation-of-parameter-choices">Explanation of parameter choices</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#achieved-phase-solutions-as-a-function-of-time-and-antenna-the-calibration-tables">Achieved phase solutions as a function of time and antenna (the calibration tables)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sb-eb1">SB EB1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sb-eb2">SB EB2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#images-made-after-each-round">Images made after each round</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-results-before-and-after">The results, before and after</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tip admonition">
<p class="admonition-title">Scripts for <strong>Step 3 - Self-calibration of the continuum</strong>:</p>
<ul class="simple">
<li><p><a href="https://github.com/jjspeedie/workflow.2021.1.0690.S/blob/main/step3_continuum_selfcal.py" target="_blank">step3_continuum_selfcal.py</a> # main script</p></li>
<li><p><a href="https://github.com/jjspeedie/workflow.2021.1.0690.S/blob/main/dictionary_data.py" target="_blank">dictionary_data.py</a> # loads data_dict</p></li>
<li><p><a href="https://github.com/jjspeedie/workflow.2021.1.0690.S/blob/main/dictionary_disk.py" target="_blank">dictionary_disk.py</a> # loads disk_dict</p></li>
<li><p><a href="https://github.com/jjspeedie/workflow.2021.1.0690.S/blob/main/selfcal_utils.py" target="_blank">selfcal_utils.py</a> # selfcal functions</p></li>
</ul>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="self-calibration-of-short-baseline-execution-blocks">
<h1>Self-Calibration of Short-Baseline Execution Blocks<a class="headerlink" href="#self-calibration-of-short-baseline-execution-blocks" title="Permalink to this heading">#</a></h1>
<section id="summary-of-path-through-self-calibration">
<h2>Summary of path through self-calibration<a class="headerlink" href="#summary-of-path-through-self-calibration" title="Permalink to this heading">#</a></h2>
<a class="mb-1 reference internal image-reference" href="../_images/ABAur_SB_concat_shifted_cont_summary.jpg"><img alt="ABAur_SB_concat_shifted_cont_summary" class="mb-1 align-center" src="../_images/ABAur_SB_concat_shifted_cont_summary.jpg" style="width: 100%;" /></a>
<p>(Note: Empty cells are not meaningless; they mean ‘’, which in CASA either means ‘all’ or ‘nothing’.)</p>
<section id="explanation-of-parameter-choices">
<h3>Explanation of parameter choices<a class="headerlink" href="#explanation-of-parameter-choices" title="Permalink to this heading">#</a></h3>
<p><strong>gaincal spw</strong>: Selecting all spectral windows.</p>
<p><strong>gaincal solint</strong>: The time interval on which to generate solutions. ‘inf’ goes as wide as the boundaries specified by the combine parameter. In the first and second round (p1, p2), 1 solution is found per scan. Later we get down to 18 seconds (3x the record interval). In the last round we find 1 solution per scan again. For reference, here’s the number of seconds in each scan, in each execution block:</p>
<figure class="align-center" id="id1">
<a class="mb-1 reference internal image-reference" href="../_images/number-seconds-in-each-scan.png"><img alt="number-seconds-in-each-scan" class="mb-1" src="../_images/number-seconds-in-each-scan.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">For the SB-only self-cal, the solints 243s, 120s, 60s, 30s, 18s roughly correspond to: half a scan, a quarter of a scan, an eighth of a scan, a sixteenth of a scan, and then 3x the record length (6s).</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><strong>gaincal combine</strong>: Dimensions of the data to combine when generating solutions. In the first two rounds, we avoid combining spectral windows (i.e., we generate per-spw solutions) to account for any per-spw phase offsets. Later, we have to combine spectral windows because the SNR of the solutions (in the line spws) is too low.</p>
<p><strong>gaincal refant</strong>: Chosen by me, using the refant lists generated by the pipeline hif_refant task, shown in the weblog. Happy coincidence (?) that the 3 highest ranked antennas in SB EB1 were the same as in SB EB2. If I was more comprehensive, I would’ve also specified the antenna’s pad, in case any were moved between executions, but the weblog did not specify the pad.</p>
<p><strong>gaincal minSNR</strong>: Minimum SNR of the solutions. If a solution has SNR below this threshold, then it (and the corresponding data) is flagged, and a statement is printed. For example: “3 of 41 solutions flagged due to SNR &lt; 3 in spw=10 at 2022/07/17/14:31:53.5”, and then later “7 of 36 solutions flagged due to SNR &lt; 3 in spw=15 at 2022/07/19/12:12:23.5”. Unfortunately there’s no way to access/save those printouts, so I just copy and paste them from the terminal into a script and count them up later. These printouts are one of the factors you use to decide whether to use the generated solutions. If applycal applymode=’calflag’, then you lose that flagged data. To get a sense of what relative amount of data did not meet the minSNR, you would have to multiply [the total number of solution intervals found (depends on solint and number of scans)] x [the number of antennas] x [the number of spectral windows (depends on combine)].</p>
<p><strong>gaincal gaintype</strong>: Could’ve used ‘G’, we only have 1 polarization mode, but DSHARP uses ‘T’.</p>
<p><strong>gaincal calmode</strong>: Sets ‘phase’ or ‘amplitude + phase’ self-cal. We attempt 1 round of amplitude+phase self-cal.</p>
<p><strong>gaincal scan</strong>: Selecting all scans.</p>
<p><strong>gaincal spwmap</strong>: I actually don’t know what this does.</p>
<p><strong>gaincal num flagged solns</strong>: See “gaincal minSNR”.</p>
<p><strong>applycal spw</strong>: Selecting all spectral windows.</p>
<p><strong>applycal applymode</strong>: Leaving is as the default (‘’), which indicates ‘calflag’, meaning we apply the calibration and apply the flags.</p>
<p><strong>applycal interp</strong>: The kind of interpolation to use between solutions. ‘Linear’ is the default. Linear ‘PD’ adds an additional term into the solve that accounts for the frequency-dependence if you have a large bandwidth. Ryan says in our case it’s overkill (“like using GR equations when in Newtonian regime”), but DSHARP uses it and I figured it doesn’t hurt.</p>
<p><strong>applycal spwmap</strong>: Leave this as ‘’ if combine does not include spw. If combine does include spw, then you need to tell applycal which spws of the calibration table to apply to which spws of the data.</p>
<div class="tip admonition">
<p class="admonition-title">Mistake later realized…</p>
<p>In the last round of self calibration on the SB concatenated data (which is amplitude+phase), combine=’’ in gaincal, but spwmap=[0,0,0,0,0,5,5,5,5,5] in applycal. In other words, solutions were generated on a per-spw basis, but then the solution for spw 0 was applied to spw 0-4, and the solution for spw 5 was applied to spw 5-9. It was a leftover relic parameter set that way because I initially did try with combine=’spw’ in gaincal (8 flagged solutions), but then changed my mind (92 flagged solutions) in favour of the chance to account for per-spw amplitude offsets, if any. I realized this mistake only after continuum selfcal was all finished. This may have ramifications later on in the continuum self-cal of the combined (SB+LB) data. I won’t make the same applycal mistake when applying the continuum self-cal solutions to the lines, but it is the case that the SB+LB solutions were generated using SB data where the wrong spwmap was applied. There aren’t really systematic offsets in the solutions between spws though, if you look at the plots below. Also, to reduce the number of flagged solutions, the SB+LB amplitude+phase selfcal (see below) was done with combine=’spw’ anyway. These two things, combined with how long it would take me to redo it at this point, suggests to me it’s not worth correcting.</p>
</div>
<p><strong>tclean imsize</strong>: Set to go out to the primary beam FWHM (~20 arcsec).</p>
<p><strong>tclean cellsize</strong>: Set to sample the beam with ~10 cells.</p>
<p><strong>tclean specmode</strong>: ‘mfs’ makes a continuum image.</p>
<p><strong>tclean deconvolver</strong>: Ryan suggested hogbom (basis of delta functions) rather than multiscale (basis of Gaussians) for disks with rings.</p>
<p><strong>tclean weighting</strong>: Briggs, of course.</p>
<p><strong>tclean spw</strong>: Using all spws to create a continuum image (we want to include the line spws in the model generation).</p>
<p><strong>tclean robust</strong>: Taken to be 0.5 for the SB self-cal, as DSHARP did, but we increase to 1.0 for the SB+LB self-cal.</p>
<p><strong>result rms (uJy/beam, mK)</strong>: Measured rms noise in the continuum image. This decreases with each round. At the end of this self-cal, we improve by a factor of 2. (Note however that these images were not cleaned very deeply, nor are they primary beam corrected).</p>
<p><strong>result peak Inu (mJy/beam)</strong>: Maximum intensity value in the image. This increases with each round, except between p6 and ap, where it decreases (to be expected).</p>
<p><strong>result disk flux (mJy)</strong>: Total flux from the disk (measured within the clean mask). This increases with each round, except between p6 and ap, where it decreases (to be expected).</p>
<p><strong>result bmin/bmin (mas)</strong>: The beam size increases with round, as we lose the flagged data (as expected). In total the beam axes both increase by about 30 mas.</p>
<p><strong>result SNR</strong>: This increases with each round, including between p6 and ap. At the end of this self-cal, we improve by a factor greater than 2.</p>
</section>
</section>
<section id="achieved-phase-solutions-as-a-function-of-time-and-antenna-the-calibration-tables">
<h2>Achieved phase solutions as a function of time and antenna (the calibration tables)<a class="headerlink" href="#achieved-phase-solutions-as-a-function-of-time-and-antenna-the-calibration-tables" title="Permalink to this heading">#</a></h2>
<p>Both SB EB1 and SB EB2 were self-calibrated together, but the following plots the solutions separately (to be able to resolve the time axis).</p>
<section id="sb-eb1">
<h3>SB EB1<a class="headerlink" href="#sb-eb1" title="Permalink to this heading">#</a></h3>
<video width="100%" controls>
  <source src="../_static/videos/SB_concat_shifted_EB1_cal.mp4" type="video/mp4">
</video>
</section>
<section id="sb-eb2">
<h3>SB EB2<a class="headerlink" href="#sb-eb2" title="Permalink to this heading">#</a></h3>
<video width="100%" controls>
  <source src="../_static/videos/SB_concat_shifted_EB2_cal.mp4" type="video/mp4">
</video>
</section>
</section>
<section id="images-made-after-each-round">
<h2>Images made after each round<a class="headerlink" href="#images-made-after-each-round" title="Permalink to this heading">#</a></h2>
<p>Image achieved after each round, with a large colour bar stretch to exaggerate faint emission.</p>
<center>
<video width="85%" controls>
  <source src="../_static/videos/SB_concat_shifted_cont.mp4" type="video/mp4">
</video>
</center>
<div class="tip admonition">
<p class="admonition-title">Thoughts…</p>
<p>There is noise outside the disk in the NW-SE directions. It becomes slightly more uniform with each round of self-cal. It wasn’t present in any of the deeply-cleaned per-execution block images.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Something to do differently…</p>
<p>Currently, we take a not-very-deeply-cleaned image as the initial or starting model for the self calibration (“SB concat shifted p0” in above movie). Perhaps a better starting model would be a more deeply cleaned image.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Jess might add here: Images of model and residuals</p>
</div>
</section>
<section id="the-results-before-and-after">
<h2>The results, before and after<a class="headerlink" href="#the-results-before-and-after" title="Permalink to this heading">#</a></h2>
<a class="mb-1 reference internal image-reference" href="../_images/SB-before-after.gif"><img alt="SB-before-after" class="mb-1 align-center" src="../_images/SB-before-after.gif" style="width: 85%;" /></a>
<p>We achieve a decrease in rms noise by a factor of 2. The peak intensity increases by about 2 mJy/beam. The SNR improves by a factor of 2.2. The outer ring becomes more uniformly bright around its azimuth and more compact/well-defined. The inner cavity becomes more radially extended and appears emptier.</p>
<p>Notice how the beam got bigger - that’s because we flagged some data.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./step3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../step2/step2-summary-of-shifts.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Summary of Phase Shifts</p>
      </div>
    </a>
    <a class="right-next"
       href="step3-selfcal-SBs%2BLBs.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Self-Calibration of SB+LB data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-path-through-self-calibration">Summary of path through self-calibration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explanation-of-parameter-choices">Explanation of parameter choices</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#achieved-phase-solutions-as-a-function-of-time-and-antenna-the-calibration-tables">Achieved phase solutions as a function of time and antenna (the calibration tables)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sb-eb1">SB EB1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sb-eb2">SB EB2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#images-made-after-each-round">Images made after each round</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-results-before-and-after">The results, before and after</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jess Speedie
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>